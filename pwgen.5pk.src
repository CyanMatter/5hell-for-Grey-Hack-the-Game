// original pwgen by usespython, additions by Plu70
if DEBUG then print("<size=75%>loading pwgen.5pk...(27.137kb)</size>")
command.pwgen = function(arg1, arg2=0, arg3=0, arg4=0)
	if arg1 == "help" or arg1 == "-h" then return "pwgen: generate a friggin lot of passwords with hashes."+char(10)+"Usage: pwgen -- generate tables/tp/ and files with one password per line"+char(10)+"Usage: pwgen hash -- generate tables/t5 and files with hash=pw one per line"+char(10)+"Use cerebrum to expand onboard dictionary."

// pwgen v0.4 author unkown, modifications by Plu70
PASSWORDSB="fifteen,abgDw32fhGu58k,sfuzzer,1111,2222,3333,00000,4444,5555,55555555,4fb426abgDw32fHG,6666,thx1138,7777,8888,9999,0000,oicu812,1337,8008,4hpu79htgbr,80085,007007,43110,69696969,t23t49k21af3,evkfdhgbv78ery,6h057,h4ck,h4ckg4m3,g01ng,p0st4l,g01ngp0st4l,81rd,7074g,35sk1m0,pr0n,n00b,nu8,suxor,hazorz,5uxzorz,owned,pwnd,0wnd,p0wn3d,w00t,woo7,woot,w007,10100111001,teh,meh,lol,brb,afk,wyd,gtfo,lmao,lmfao,gitgud,lawl,troll,bawl,epic,54321,987654321,88888888,555555,1234567890,1973,147147,151515,1515,101010,202020,21122112,12341234,74lk,dir7y,53nP4I,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,1,2,3,4,5,6,7,8,9,0,le375p34k,420420,11111111,112233,h4f4jf53fk74,123abc,1234qwer,123321,5y4hpu79htgbrub,ncc1701e,7777777,51505150,000000,5150,222222,999999,252525,77777777,98765432,poop,polyamorous,zelda,password,6gtr43,123456,12345678,1234,qwerty,12345,dragon,baseball,football,letmein,monkey,696969,abc123,mustang,michael,shadow,master,jennifer,111111,2000,jordan,superman,harley,1234567,hunter,trustno1,ranger,buster,thomas,tigger,robert,soccer,batman,test,pass,hockey,george,charlie,andrew,michelle,love,sunshine,jessica,6969,pepper,daniel,access,123456789,654321,joshua,maggie,starwars,silver,william,dallas,yankees,123123,ashley,666666,hello,amanda,orange,biteme,freedom,computer,sexy,thunder,nicole,ginger,heather,hammer,summer,corvette,taylor,swift,austin,1111,merlin,matthew,121212,golfer,cheese,princess,martin,chelsea,patrick,richard,diamond,yellow,bigdog,secret,asdfgh,sparky,cowboy,camaro,anthony,matrix,falcon,iloveyou,bailey,guitar,jackson,purple,scooter,phoenix,aaaaaa,morgan,tigers,porsche,mickey,maverick,cookie,nascar,peanut,justin,131313,money,horny,samantha,panties,steelers,joseph,snoopy,boomer,whatever,iceman,smokey,gateway,dakota,cowboys,eagles,chicken,black,zxcvbn,please,pharoa,andrea,ferrari,knight,hardcore,porn,ass,love,sex,hooker,blow,coke,melissa,compaq,coffee,booboo,bitch,johnny,bulldog,xxxxxx,welcome,james,player,ncc1701,wizard,scooby,charles,junior,internet,mike,brandy,tennis,banana,monster,spider,lakers,miller,rabbit,enter,mercedes,brandon,steven,fender,john,yamaha,diablo,chris,boston,tiger,marine,chicago,rangers,gandalf,winter,bigtits,barney,edward,raiders,porn,badboy,blowme,spanky,bigdaddy,johnson,chester,london,midnight,blue,fishing,hannah,slayer,rachel,sexsex,redsox,asdf,marlboro,panther,zxcvbnm,arsenal,oliver,qazwsx,mother,victoria,jasper,angel,david,winner,crystal,golden,butthead,viking,jack,iwantu,shannon,murphy,angels,prince,cameron,girls,madison,wilson,carlos,hooters,willie,startrek,captain,maddog,jasmine,butter,booger,angela,golf,lauren,rocket,tiffany,theman,dennis,liverpoo,flower,forever,green,jackie,muffin,turtle,sophie,danielle,redskins,toyota,jason,sierra,winston,debbie,giants,packers,newyork,jeremy,casper,bubba,dracula,sandra,lovers,mountain,united,cooper,driver,tucker,helpme,pookie,lucky,maxwell,8675309,bear,suckit,gators,shithead,jaguar,monica,fred,happy,hotdog,tits,gemini,lover,xxxxxxxx,777777,canada,nathan,victor,florida,nicholas,rosebud,metallic,doctor,trouble,success,stupid,tomcat,warrior,peaches,apples,fish,qwertyui,magic,buddy,dolphins,rainbow,gunner,987654,freddy,alexis,braves,2112,1212,xavier,dolphin,testing,bond007,member,calvin,voodoo,7777,samson,alex,apollo,fire,tester,chess,walter,beavis,voyager,peter,porno,bonnie,rush2112,beer,apple,scorpio,jonathan,skippy,sydney,scott,red123,power,gordon,travis,beaver,star,flyers,232323,zzzzzz,steve,rebecca,scorpion,doggie,legend,ou812,yankee,blazer,bill,runner,birdie,bitches,parker,topgun,asdfasdf,heaven,viper,animal,bigboy,arthur,baby,private,godzilla,donald,williams,lifehack,phantom,dave,rock,august,sammy,cool,brian,platinum,jake,bronco,paul,mark,frank,heka6w2,copper,billy,cumshot,garfield,willow,cunt,little,carter,slut,albert,kitten,super,jordan23,eagle1,shelby,america,11111,jessie,house,free,chevy,bullshit,white,broncos,horney,surfer,nissan,saturn,airborne,elephant,marvin,shit,action,adidas,qwert,kevin,1313,explorer,walker,police,christin,december,benjamin,wolf,sweet,therock,king,online,brooklyn,teresa,cricket,sharon,dexter,racing,penis,gregory,0000,teens,redwings,dreams,michigan,hentai,magnum,87654321,nothing,donkey,trinity,digital,333333,ramsesii,stella,cartman,guinness,speedy,buffalo,kitty,pimpin,eagle,einstein,kelly,nelson,nirvana,vampire,xxxx,playboy,louise,pumpkin,snowball,test123,girl,sucker,mexico,beatles,fantasy,ford,gibson,celtic,marcus,cherry,cassie,888888,natasha,sniper,chance,genesis,hotrod,reddog,alexande,college,jester,passw0rd,smith,lasvegas,carmen,slipknot,death,kimberly,1q2w3e,eclipse,1q2w3e4r,stanley,samuel,drummer,homer,montana,music,aaaa,spencer,jimmy,carolina,colorado,creative,hello1,rocky,goober,friday,AceofSpades,bollocks,scotty,abcdef,bubbles,hawaii,asakista,fluffy,mine,stephen,horses,thumper,darkness,asdfghjk,pamela,boobies,buddha,vanessa,sandman,naughty,douglas,honda,matt,azerty,6666,shorty,money1,beach,loveme,4321,simple,poohbear,444444,badass,destiny,sarah,denise,vikings,lizard,melanie,assman,sabrina,nintendo,water,good,howard,time,123qwe,november,xxxxx,october,zxcv,shamrock,atlantis,warren,wordpass,julian,mariah,rommel,1010,harris,predator,sylvia,massive,cats,sammy1,mister,stud,marathon,rubber,ding,trunks,desire,montreal,justme,faster,kathleen,irish,1999,bertha,jessica1,alpine,sammie,diamonds,tristan,swinger,shan,stallion,pitbull,letmein2,roberto,ready,april,palmer,ming,shadow1,audrey,chong,clitoris,wang,shirley,jackoff,bluesky,sundance,renegade,hollywoo,bernard,wolfman,soldier,picture,pierre,ling,goddess,manager,nikita,76hj93DB3wsa2,sweety,titans,hang,fang,ficken,niners,bottom,bubble,hello123,ibanez,webster,sweetpea,stocking,freeman,french,mongoose,speed,dddddd,hong,henry,hungry,yang,catdog,cheng,ghost,gogogo,randy,tottenha,curious,butterfl,mission,january,singer,sherman,shark,techno,lancer,lalala,autumn,chichi,orion,trixie,clifford,delta,bobbob,bomber,holden,kang,kiss,1968,spunky,liquid,mary,beagle,granny,network,bond,kkkkkk,millie,biggie,beetle,teacher,susan,toronto,anakin,genius,dream,dang,bush,nyx".split(",")
PASSWORDSA="323232,osint,msfconsole,Bd5gHie89YA,tornado,lindsey,content,bruce,buck,aragorn,griffin,chen,campbell,trojan,christop,newman,wayne,tina,rockstar,father,geronimo,pascal,crimson,brooks,hector,penny,anna,camera,chandler,fatcat,lovelove,cody,cunts,waters,stimpy,finger,cindy,wheels,viper1,latin,robin,greenday,creampie,brendan,hiphop,willy,snapper,funtime,duck,trombone,adult,cotton,cookies,kaiser,mulder,westham,latino,jeep,ravens,aurora,drizzt,madness,hermit,energy,kinky,314159,leather,bastard,young,,extreme,hard,password1,vincent,lacrosse,hotmail,spooky,amateur,alaska,badger,paradise,maryjane,soup,crazy,mozart,video,russell,vagina,spitfire,anderson,norman,otaku,eric,cherokee,cougar,barbara,long,family,horse,enigma,allison,raider,brazil,blonde,jones,55555,dude,drowssap,jeff,school,marshall,lovely,1qaz2wsx,jeffrey,caroline,franklin,booty,molly,snickers,leslie,nipples,courtney,diesel,rocks,eminem,westside,suzuki,daddy,passion,hummer,ladies,Azachary,frankie,elvis,reggie,alpha,suckme,simpson,patricia,pirate,tommy,semperfi,jupiter,redrum,freeuser,wanker,stinky,ducati,paris,natalie,babygirl,bishop,windows,spirit,tiktok,thot,pantera,monday,patches,brutus,houston,smooth,penguin,marley,forest,cream,212121,flash,maximus,nipple,bobby,bradley,vision,pokemon,champion,fireman,indian,softball,picard,system,clinton,cobra,enjoy,lucky1,claire,claudia,boogie,timothy,marines,security,dirty,admin,wildcats,pimp,dancer,hardon,veronica,abcd1234,abcdefg,ironman,wolverin,remember,great,freepass,bigred,squirt,justice,francis,hobbes,kermit,pearljam,mercury,domino,9999,denver,brooke,rascal,hitman,mistress,simon,tony,bbbbbb,friend,peekaboo,naked,budlight,electric,sluts,stargate,saints,bondage,brittany,bigman,zombie,swimming,duke,qwerty1,babes,scotland,disney,rooster,brenda,mookie,swordfis,candy,duncan,olivia,hunting,blink182,alicia,8888,samsung,bubba1,whore,virginia,general,passport,aaaaaaaa,erotic,liberty,arizona,jesus,abcd,newport,skipper,rolltide,balls,happy1,galore,christ,weasel,242424,wombat,digger,classic,bulldogs,poopoo,accord,popcorn,turkey,jenny,amber,bunny,mouse,titanic,liverpool,dreamer,everton,friends,chevelle,carrie,gabriel,psycho,nemesis,burton,pontiac,connor,eatme,lickme,roland,cumming,mitchell,ireland,lincoln,arnold,spiderma,patriots,goblue,devils,eugene,empire,asdfg,cardinal,brown,shaggy,froggy,qwer,kawasaki,kodiak,people,phpbb,light,kramer,chopper,hooker,honey,whynot,lisa,baxter,adam,snake,ncc1701d,qqqqqq,airplane,britney,avalon,sandy,sugar,sublime,stewart,wildcat,raven,scarface,elizabet,123654,trucks,wolfpack,lawrence,raymond,american,alyssa,bambam,movie,woody,shaved,snowman,tiger1,chicks,raptor,1969,stingray,shooter,france,stars,madmax,kristen,sports,jerry,789456,garcia,simpsons,lights,ryan,looking,chronic,alison,hahaha,packard,hendrix,perfect,service,spring,srinivas,spike,katie,oscar,brother,bigmac,suck,single,cannon,georgia,popeye,tattoo,texas,party,bullet,taurus,sailor,wolves,panthers,japan,strike,flowers,pussycat,chris1,loverboy,berlin,sticky,marina,tarheels,fisher,russia,connie,wolfgang,testtest,mature,bass,catch22,juice,michael1,159753,women,alpha1,trooper,hawkeye,head,freaky,dodgers,pakistan,machine,pyramid,vegeta,katana,moose,tinker,coyote,infinity,inside,letmein1,bang,control,hercules,morris,james1,tickle,outlaw,browns,billybob,pickle,test1,michele,antonio,sucks,pavilion,changeme,caesar,prelude,tanner,adrian,darkside,bowling,wutang,sunset,robbie,alabama,danger,zeppelin,juan,rusty,pppppp,nick,2001,ping,darkstar,madonna,qwe123,bigone,casino,cheryl,charlie1,mmmmmm,lakota,akota,integra,wrangler,apache,tweety,qwerty12,bobafett,simone,none,business,sterling,trevor,transam,dustin,harvey,england,2323,seattle,ssssss,rose,harry,openup,pandora,trucker,wallace,indigo,storm,malibu,weed,review,babydoll,doggy,dilbert,pegasus,joker,catfish,flipper,valerie,herman,detroit,kenneth,cheyenne,bruins,stacey,smoke,joey,seven,marino,fetish,xfiles,wonder,stinger,pizza,babe,pretty,stealth,manutd,gracie,gundam,cessna,longhorn,presario,mnbvcxz,wicked,mustang1,victory,shelly,awesome,athena,q1w2e3r4,help,holiday,knicks,street,redneck,casey,gizmo,scully,dragon1,devildog,triumph,eddie,bluebird,shotgun,peewee,hubris,ronnie,angel1,daisy,special,metallica,madman,country,impala,lennon,roscoe,omega,access14,enterpri,miranda,search,smitty,blizzard,unicorn,tight,rick,ronald,asdf1234,harrison,trigger,truck,danny,home,winnie,beauty,thailand,cadillac,castle,tyler,bobcat,buddy1,sunny,stones,asian,freddie,chuck,butt,loveyou,norton,hellfire,hotsex,indiana,short,panzer,lonewolf,trumpet,colors,blaster,12121212,fireball,logan,precious,aaron,elaine,jungle,masamune,atlanta,gold,corona,curtis,nikki,polaris,timber,theone,baller,chipper,orlando,island,skyline,dragons,dogs,benson,licker,goldie,engineer,kong,pencil,basketba,open,hornet,world,linda,barbie,chan,farmer,valentin,indians,larry,redman,foobar,travel,morpheus,bernie,target,141414,hotstuff,photos,laura,savage,holly,rocky1,dollar,turbo,design,newton,hottie,moon,blondes,4128,lestat,avatar,future,goforit,random,abgrtyu,jjjjjj,q1w2e3,smiley,goldberg,express,zipper,wrinkle1,stone,andy,babylon,dong,powers,consumer,dudley,Aster,monkey1,serenity,samurai,99999999,skeeter,lindsay,joejoe,master1,aaaaa,chocolat,christia,birthday,stephani,tang,alfred,ball,maria,sexual,maxima,sampson,buckeye,highland,kristin,seminole,reaper,bassman,nugget,lucifer,airforce,nasty,watson,warlock,2121,philip,always,dodge,chrissy,burger,bird,snatch,missy,pink,gang,maddie,holmes,huskers,piglet,photo,joanne,hamilton,dodger,paladin,christy,chubby,buckeyes,hamlet,abcdefgh,bigfoot,sunday,manson,goldfish,garden,deftones,icecream,blondie,spartan,julie,harold,charger,brandi,stormy,sherry,pleasure,juventus,rodney,galaxy,holland,escort,zxcvb,planet,jerome,wesley,blues,song,peace,david1,1966,cavalier,gambit,karen,sidney,ripper,jamie,sister,marie,martha,nylons,aardvark,nadine,minnie,whiskey,bing,plastic,anal,babylon5,chang,savannah,loser,racecar,insane,yankees1,mememe,hansolo,chiefs,fredfred,freak,frog,salmon,concrete,yvonne,sophia,stefan,8a1n80w,slick,rocker,opensesame,onessnap".split(",")
PASSWORDSC="123456789098765,123,abc,a,b,m,n,k,user,Password1,pass,012345678909876,abgDw32fhGu58k,Bd5gHie89YA,HG54h49lklj4G53,Bd5gHie89YA,59038qyghq340fg,tgby2hnr4fv9ujm,abcplm123098tg6,3dsvi2psdfn34,a03nf93nf8,3edv45gb8ub202n,afdiounwrnnfsa,234086531230324,111111111111111,222222222222222,333333333333333,444444444444444,55555555555555,666666666666666,777777777777777,888888888888888,999999999999999,000000000000000,efh368jhr08712,asdfghjkl102938,ghfjdkslatywoec,bogu2847mshd02,1357924680aoejd,g35gk5k63l10,d0emgh4m43la,ae51wc3g7d9c,GHEITHEKA102938,HHHHHHHHHHHHH,AAAAAAAAAAAAAAAA,RRRRRRRRRRRRRRRR,sssssssssssssss,ttttttttttttttt,llllllllllllll,eeeeeeeeeeeee,uuuuuuuuuuuu,oooooooooo,aaaaaaaa,1234,123,987,567,654,56432,12345,55555,99999,34567,jhgfd,uiopl,mnbvc,ytrewq,iuhhfd,sadregh,01010101010101,1010101010101010,000111000111000,einagearghaaer,235gdfa5yhgea,aletgadfgraerga,0k9j8h7g6f5f4ed2,afdsawe4togfido,butyrhdncbuh,39n8nf93fk59,adfsafawefgaag,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,1,2,3,4,5,6,7,8,9,0".split(",")
PASSWORDS = PASSWORDSA + PASSWORDSB
if arg2 == "-p" then PASSWORDS = PASSWORDSC
String={}
String.capitalize=function(s)
  if s.len<2 then return s.upper
  return s[0].upper+s[1:].lower
end function
String.strip=function(t,s)
  if not t then return ""
  for b in range(0,t.len-1)
    if s.indexOf(t[b])==null then break
  end for
  if s.indexOf(t[b])>=0 then return ""
  for e in range(-1,-1*t.len)
    if s.indexOf(t[e])==null then break
  end for
  if e==-1 then return t[b:]
  return t[b:e+1]
end function
PasswordGenerator={}
PasswordGenerator.init=function(samples)
  self.s=[]
  self.c={}
  for s in samples
    s=s.trim.upper
    if s.len>3 then self.s.push(s)
  end for
  for s in self.s
    for i in range(0,s.len-4)
      k=s[i:i+3]
      if self.c.hasIndex(k) then
        if self.c[k].indexOf(s[i+3])==null then self.c[k].push(s[i+3])
      else
        self.c[k]=[s[i+3]]
      end if
    end for
  end for
end function
PasswordGenerator.AllPasswords=function()
  r={}
  for s in self.s
    for i in range(0,s.len-4)
      self.r(s.len,s[i:i+3],r)
    end for
  end for
	print(colorGold+"50%"+CT+" -- loading hash_table...")
	print("<align=center>"+char(171)+char(187)+"</align>")
  o={}
  for s in r.indexes
    if s.indexOf(" ")>=0 then
      n=s.split(" ")
      i=n.indexOf("")
      while i>=0
        n.remove(i)
        i=n.indexOf("",i-1)
      end while
      if n then
        for i in range(0,n.len-1)
          n[i]=String.capitalize(n[i])
        end for
      end if
      s=n.join(" ")
    else
      s=String.capitalize(s)
    end if
    if s.len<5 then continue
    a=s[0]
    b=s[1]
    if a.lower==b or "hrl'aeiou".indexOf(b)==null and "AEIOUS".indexOf(a)==null and ["Ch","Mc"].indexOf(a+b)==null then s=String.capitalize(s[1:])
    s=String.strip(s,"'-")
    o[s]=1
    o[s.lower]=1
  end for
  r={}
	print(colorGold+"75%"+CT+" -- loading hash_table...")
	print("<align=center>"+char(171)+char(187)+"</align>")
	if arg1 == "false" then return o.indexes
  for i in o.indexes
    r[md5(i)]=i
  end for
  return r
end function
PasswordGenerator.r=function(l,s,o)
  c=s[s.len-3:]
  if self.c.hasIndex(c) and s.len<l then
    for c in self.c[c]
      self.r(l,s+c,o)
    end for
  else
    o[s]=1
  end if
end function
if globals.BIGBRAIN then 
	if arg1 == "false" then
		return "Dictionary already expaneded."
	end if
	print(colorGold+"0% -- loading hash_table, please wait..."+CT)
	HASH_TABLE = {}
	for pw in globals.dict_a
		HASH_TABLE[md5(pw)] = pw
	end for
	print(colorGold+"100%"+CT+" -- hash_table loaded...")
else
	print(colorGold+"0% -- loading hash_table, please wait..."+CT)
	if arg1 == "-t" or arg2 == "-t" then 
		PasswordGenerator.init(PASSWORDSC)	
	else 
		PasswordGenerator.init(PASSWORDS)
	end if
	//PasswordGenerator.init(globals.dict_a)
	//PasswordGenerator.init(globals.dict_a+PASSWORDS)
	//PasswordGenerator.init(PASSWORDS[0:arg2])
	//
	print(colorGold+"10%"+CT+" -- loading hash_table...")
	print("<align=center>"+char(171)+char(187)+"</align>")
	HASH_TABLE=PasswordGenerator.AllPasswords
	print(colorGold+"100%"+CT+" -- hash_table loaded...")
	print("<b>Magnum Cerebrum: expanding onboard dictionary...</b>")
	// globals.dict_a = HASH_TABLE.values
	if arg2 == "-p" then globals.dict_a = globals.dict_a + HASH_TABLE.values + PASSWORDSA + PASSWORDSB + PASSWORDSC else globals.dict_a = HASH_TABLE.values
	globals.BIGBRAIN = true
	if arg1 == "false" then
		return "Dictionary expaneded."
	end if
end if
table = "tp"
if arg1 == "hash" then table = "t5"
print(print(colorGold+"Writing tables to <u>"+home_dir+"/tables/"+table+CT))
print(colorGold+"Hash Table: ["+colorWhite+HASH_TABLE.len+"</color>]")
print("<align=center>"+char(171)+char(187)+"</align>")
out=[]
count=0
lol=1
for i in HASH_TABLE
	count=count+1
	if arg1 == "hash" then
		//out=out+char(10)+i["key"]+"="+i["value"]
		out.push(i["key"]+"="+i["value"])
	else
    	//out=out+char(10)+i["value"]
		out.push(i["value"])
	end if
    output = out.join(char(10))
	if output.len > 159900 then
		print(lol+" "+out.len+" "+output.len)
		localmachine.touch(home_dir+"/tables/"+table,lol+"")
		file=localmachine.File(home_dir+"/tables/"+table+"/"+lol)
		file.set_content(output)
		command.perms("o-rwx",file)
		out=[]
		lol=lol + 1
	end if
end for

if out.len > 1 then
	print(lol+" "+HASH_TABLE.len+" "+out.len)
	localmachine.touch(home_dir+"/tables/"+table,lol+"")
	file=localmachine.File(home_dir+"/tables/"+table+"/"+lol)
	file.set_content(out.join(char(10)))
	command.perms("o-rwx",file)
	out=""
	lol=lol + 1
end if

return file.path
end function
command.brutus = function(arg1, arg2=0, arg3=0, arg4=0, arg5=0)
	if arg1 == "-h" or arg1 == "help" then return "Usage: brutus -- attempt to gain root pass and shell using onboard dict_a "+char(10)+"(Default onboard dict_a: ["+colorGold+globals.dict_a.len+CT+"] passwords)"+char(10)+"Usage: brutus -i [/path|object] -- import dictionary (may be csv or newline separated values)"+char(10)+"-- 5hell will attempt to determine the type. Please ensure valid inputs."+char(10)+"-- accepts: path to file or folder, or piped file/folder object"+char(10)+"-- See dfit for making a.csv from newline separated dictionary file."+char(10)+"-- See cerebrum for altering onboard dict_a"+char(10)+"Advanced: brutus -s [shell_object] [ip] -- use shell_object to initiate ssh + brutus attack against ip "+char(10)+"(equal to command.ssh root@-brutus [ip] but uses the given shell instead of active shell)"
	dic = globals.dict_a
	u_name = "root"
	ip = ""
	port = 22
	b_remote = false
	if arg1 == "-i" and arg1.len == 2 then
	 	if arg2 and arg2 != "0" then
			if typeof(arg2) == "string" then
				dic = globals.get_file(arg2)
			else
				if typeof(arg2) == "file" then
					dic = arg2
				else
					return "brutus: valid option -i [/path|file_object] -- import dictionary file"
				end if
			end if
		else
			return "brutus: valid option -i [/path|file_object] -- import dictionary file"
		end if
	end if
	if DEBUG then print("arg1: "+arg1+char(10)+"arg2: "+arg2+char(10)+dic)
	if not dic then return("Dictionary: "+arg2+" not found")
	print(colorGold+"Brutus: accessing dictionary..."+CT)
	if arg1 == "-s" and arg2 and typeof(arg2) == "shell" then
		print(colorLightBlue+"brutus: </b>Configuring remote attack...<b>"+CT)
		if arg3 and arg4 then
			if arg5 then port = arg5
			if typeof(port) != "number" then port = port.to_int
			if typeof(port) != "number" then return colorRed+"brutus: invalid port"+CT
			ip = arg4
			u_name = arg3
		else
			if arg3 then u_name = arg3
			ip = user_input("root@ip: ")
		end if
		if is_valid_ip(ip) then
			print("<b>brutus: remote attack configured.</b>")
			stop = user_input(colorRed+"WARNING:"+colorOrange+"Continuing will fill the terminal with ["+colorGold+globals.dict_a.len+colorOrange+"] connection attempts."+char(10)+" This cannot be avoided. Continue? [Y/n] "+CT)
			if stop == "n" or stop == "N" then return "aborting..."
			b_remote = true
		else
			return colorRed+"Brutus: invalid ip."+CT
		end if
	end if
	if typeof(dic) == "file" then
	 	if not dic.is_binary then
			d_buf = dic.get_content
			if d_buf.indexOf(",") > 0 then
				dic = d_buf.trim.split(",")
			else
				dic = d_buf.split(char(10))
			end if
		else
			if dic.is_folder then
				df = dic.get_folders
				box = []
				for f in df
					f_buf = f.get_content
					if f_buf.indexOf(",") > 0 then
						dic_buf = f_buf.trim.split(",")
					else
						dic_buf = f_buf.split(char(10))
					end if
					for d in dic_buf
						box.push(d)
					end for
				end for
				dic = box[0:]
			else
				return "brutus: invalid dictionary input."+char(10)+"got: binary_file. expected: folder or ascii file."
			end if
		end if
	end if
	if typeof(dic) != "list" then return "brutus: dictionary error."
	if DEBUG then print("d_len: "+dic.len)
	for d in dic
		if b_remote then
			root = shell.connect_service(ip, port, u_name, d)
		else
			root = get_shell("root", d)
		end if
		if typeof(root) == "shell" then
			print("root:"+colorGold+""+d+""+CT)
			print("clipa: "+command.clipa(d))
			//print("brutus: writing to dump.txt")
			//command.poke("dump.txt",char(10)+"root:"+d+char(10))
			globals.BUFFER.push(root)
			print("<b>Shell sent to BUFFER. Access via Memory Alpha (<u>malp</u> command)</b>")
			//go = user_input("Start terminal? [y/N]"+char(10)+"||: ",0,1)
			//if go.lower == "y" then
			//	root.start_terminal
			//end if
			return root
		end if
	end for
	print("...brute force attack failed.")
	return 0
end function
command.cerebrum = function(arg1, arg2, arg3=0, arg4=0)
	if arg1 == "-h" or arg1 == "help" then return "Magnum Cerebrum: big brain. "+char(10)+"Expand dict_a to 300k+ passwords for this runtime instance. Returns zero."+char(10)+"(Use <b>pwgen</b> instead to save passwords locally)."+char(10)+"Advanced: cerebrum -i [/path/to/file|file_object] -- import a custom dictionary (may be csv or nsv: ',' or char(10) )"+char(10)+"n.b. -- may be file, directory or piped object"+char(10)+"Advanced: cerebrum -i [/path/to/folder] -- import all text files in folder to expand onboard dictionary. must be of type <b>newline</b> separated values. Incorrect data will corrupt the dictionary."+char(10)+"Advanced: cerebrum -p -- load only common player passwords (wip)"+char(10)+"Advanced: cerebrum -i @home -- import dictionary file or folder from @home server"+char(10)+"-- searches /root/tables/tp on @home server"+char(10)+"-- see help @home for more information about the @home server."
	if arg1 == "-i" and not arg2 then return "cerebrum: -i expects /path or file_object or @home."
	infile = null
	if arg1 == "--purge" then 
		globals.dict_a=["a"]
		globals.BIGBRAIN = false
		return "cerebrum: dictionary purged."
	end if
	if arg1 == "-i" and arg2 then
		if typeof(arg2) == "list" then
			globals.dict_a = arg2
			if dict_a.len > 0 then return "cerebrum: ["+colorGold+globals.dict_a.len+CT+"] passwords ready. " else return "cerebrum: import error. dictionary corrupted."
		end if
		if typeof(arg2) == "string" then
			if arg2 == "@home" then
				r_ip = ""
				r_p = "22"
				if params and params.len > 1 then
					r_ip = params[0]
					r_p = params[1].to_int
				else
					r_ip = targ.ip
					r_p = targ.pt
				end if
				if not is_valid_ip(r_ip) then return "cerebrum: set remote ip and port with command.target [ip] [port] before using -i @home option."
				r_pas = ""
				//if params and params.len > 2 then
					//r_pas = params[2]
				//else
					r_pas = user_input("@home_server_password (leave blank to abort)"+char(10)+":> ", 1)
				//end if
				if r_pas.replace(" ","") == "" then return("aborting...")
				r_r = shell.connect_service(r_ip, r_p, "root", r_pas)
				if r_r and typeof(r_r) == "shell" then
					infile = r_r.host_computer.File("/root/tables/tp")
					if not infile then return (colorRed+"404: /root/tables/tp not found. Run pwgen on remote host."+CT)
				else
					return (colorRed+"222: remote server unreachable."+CT)
				end if
			else
				infile = globals.get_file(arg2)
			end if
		else
			if typeof(arg2) == "file" then
				infile = arg2
			else
				return "cerebrum: invalid type. expects /path or file_object or @home."
			end if
		end if
		print(colorGold+"Importing..."+char(10)+colorGold+"<align=center><<>></align>"+CT)
		if infile and not infile.is_binary then
			d_b = infile.get_content
			globals.dict_a = []
			if d_b.indexOf(",") > 0 then
				globals.dict_a = globals.dict_a + d_b.split(",")
			else
				globals.dict_a = globals.dict_a + d_b.split(char(10))
			end if
		else
			if infile and infile.is_folder then
				globals.dict_a = []
				for dfile in infile.get_files
					if dfile.has_permission("r") and not dfile.is_binary then
						d_b = dfile.get_content
						delim = ""
						if d_b.indexOf(",") > 0 then
							//globals.dict_a = globals.dict_a + dfile.get_content.split(",")
							delim = ","
						else
							//globals.dict_a = globals.dict_a + dfile.get_content.split(char(10))
							delim = char(10)
						end if
						if DEBUG then print("dict_a: "+dict_a.len)
						if globals.dict_a.len < 710000 then 
							for d in d_b.split(delim)
								globals.dict_a.push(d) 
							end for
						else 
							print("cerebrum: max dict length reached. Could not load: "+dfile.path)
						end if
					end if
				end for
			else
				return "cerebrum: import error [411]."
			end if
		end if
		if dict_a.len > 0 then 
			globals.BIGBRAIN = true
			return "cerebrum: ["+colorGold+dict_a.len+CT+"] passwords ready. " 
		else 
			return "cerebrum: import error. dictionary corrupted."
		end if
	end if
	if globals.BIGBRAIN then return "Magnum Cerebrum already active."+char(10)+"Run the command: <b>cerebrum --purge</b> to reset."
	print(colorGold+"<align=center> Magnum Cerebrum </align>"+CT)
	print(colorGold+"- - - - - - - - - - - - - - - - - - - - - - - - - -"+CT)
	//globals.BIGBRAIN = true
	time_s = time
	if DEBUG then print("cerebrum calling: pwgen false "+arg1)
	command.pwgen("false",arg1)
	time_e = (time - time_s)
	print( globals.dict_a.len+" passwords readied in "+time_e+" seconds." )
	if arg1 == "-d" or arg2 == "-d" or arg3 == "-d" then return dict_a else return 0
end function
